---
title: "Bollywood Movies"
output: html_document
date: "2025-02-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(janitor)
library(naniar)
library(ggplot2)
library(RColorBrewer)
```


```{r}
options(scipen=999) #turning off scientific notation
```


Load Data:
```{r}
movies1 <- read_csv("bollywood.csv") %>% 
  clean_names() %>% 
  rename(title=movie_name) %>% 
  mutate(across(where(is.character), tolower)) #changing all characters to lowercase
```

```{r}
movies2 <- read_csv("bollywood_hits.csv") %>% 
  clean_names() %>% 
  mutate(across(where(is.character), tolower))
```

Join Data:
```{r}
movie_join <- inner_join(movies1, movies2, by="title")
```



Cleaning the Data
```{r}
bollywood <- movie_join %>% 
  select(-genre.y, -actors, -directors, -imdb_id) %>% #removing duplicate columns
  rename(genre=genre.x) %>% 
  separate(release_date, into=c("date", "month", "year"), sep=" ") %>% #separate the date column
  replace_with_na_all(condition = ~.x == "n/a") %>% 
  select(-release_year) #removing duplicate year column
  
```

Assessing data:

```{r}
summary(bollywood)
```

```{r}
miss_var_summary(bollywood)
```





#Change Over Time

1. How does the number of movies released change over the years?
```{r}
bollywood %>% 
  filter(year != "NA") %>% 
  ggplot(aes(x=as.factor(year), fill=year))+
  geom_bar()+
  scale_fill_brewer(palette="RdYlGn")+
  labs(title="Movies per Year", x="Year", y="Number Movies")+
  theme(plot.title = element_text(hjust=0.5, size=15))
```
2011 has highest number of movies and 2006 has the lowest

2. Could the drop in movies in 2006 be related to the number of new directors?
```{r}
bollywood %>% 
  filter(new_director=="yes", year!="NA") %>% 
  group_by(year) %>% 
  summarize(n_uniq=n_distinct(director))%>% 
  ggplot(aes(x=as.factor(year), y=n_uniq))+
  geom_col()
```
2006 is the year with the fewest directors entering the field; corresponds to fewest movies released
2011 is the year with the highest new directors entering the field; corresponds to most movies released


3. Did those two years also have the highest and lowest average revenues?

```{r}
bollywood %>% 
  filter(year != "NA") %>% 
  ggplot(aes(x=year, y=revenue_inr))+
  geom_boxplot()
```
Number of high outliers increase over time
Hard to see change in average revenue due to scaling of y axis

```{r}
bollywood %>% 
  filter(year != "NA") %>% 
  group_by(year) %>%
  summarize(avg_rev=mean(revenue_inr)) %>% 
  ggplot(aes(x=year, y=avg_rev))+
  geom_point()
```
Average revenue is generally increasing over time but there is a drop from 2009-2011



4. How do genres of movies released change over the years?
```{r}
bollywood %>% 
  filter(year != "NA") %>% 
  group_by(year, genre) %>%
  summarize(n=n()) %>% 
  ggplot(aes(x=as.factor(year), group=genre, y=n, color=genre))+
  geom_point()+
  geom_line()
```
drama had a huge peak in 2011 (almost 20 more movies compared to 2010)
suspense rose from 2010-2013


5. Look at genres of top 10 high earning movies each year. Is the proportion of drama movies increasing leading up to 2011?
```{r}
bollywood %>%
  filter(year != "NA") %>% 
  group_by(year) %>% 
  top_n(10, revenue_inr) %>% 
  ggplot(aes(x=year, fill=genre))+
  geom_bar()+
  scale_fill_brewer(palette="RdYlGn")
```
Proportion of drama movies is not increasing leading up to 2011. But drama movies make up half of the top 10 highest revenue films in 2011.






