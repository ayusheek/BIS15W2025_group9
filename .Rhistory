bollywood %>%
filter(year %in% c(2013, 2014)) %>%
filter(genre=="masala") %>%
select(title, lead_star, director, year, revenue_inr)
bollywood %>%
filter(lead_star=="ajay devgn" | lead_star=="shahrukh khan"| lead_star=="ranveer singh") %>%
group_by(year, lead_star) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev, group=lead_star, color=lead_star))+
geom_point()+
geom_line()+
labs(title="Avg Movie Revenue Over Time", x="Year", y="Average Revenue", color="Actor")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(director=="sajid khan" | director=="ali abbas zafar"| director=="farah khan" | director=="rohit shetty") %>%
group_by(year, director) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev, group=director, color=director))+
geom_point()+
geom_line()+
labs(title="Avg Movie Revenue Over Time", x="Year", y="Average Revenue", color="director")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(director=="sajid khan" | director=="ali abbas zafar"| director=="farah khan" | director=="rohit shetty") %>%
group_by(year, director) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev, group=director, color=director))+
geom_point()+
geom_line()+
labs(title="Avg Movie Revenue Over Time", x="Year", y="Average Revenue (INR)", color="director")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(lead_star=="ajay devgn" | lead_star=="shahrukh khan"| lead_star=="ranveer singh") %>%
group_by(year, lead_star) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev, group=lead_star, color=lead_star))+
geom_point()+
geom_line()+
labs(title="Avg Movie Revenue Over Time", x="Year", y="Average Revenue (INR)", color="Actor")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year %in% c(2012, 2013, 2014)) %>%
filter(!genre %in% c("adult", "suspense","fantasy")) %>% #removing genres whose revenues don't change much to make plot clearer
ggplot(aes(x=genre, y=revenue_inr/10000, fill=genre))+
geom_boxplot()+
facet_wrap(~year)+
scale_fill_brewer(palette="RdYlGn")+
coord_flip()+
theme(axis.text.x=element_text(angle=20))+
labs(title="Revenue Range over Time", y="Revenue x 10^-3 (INR)", x="Genre")
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="skyblue")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
group_by(year) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev))+
geom_col(fill="skyblue", color="black")+
labs(title="Average Revenue over Time", x="Year", y="Average Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
group_by(year) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev))+
geom_col(fill="skyblue", color="black")+
labs(title="Average Revenue over Time", x="Year", y="Average Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(new_director=="yes", year!="NA") %>%
group_by(year) %>%
summarize(n_uniq=n_distinct(director))%>%
ggplot(aes(x=as.factor(year), y=n_uniq))+
geom_col(fill="skyblue", color="black")+
labs(title="New Directors per Year", x="Year", y="Number of New Directors")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=as.factor(year)))+
geom_bar(fill="skyblue", color="black")+
labs(title="Movies per Year", x="Year", y="Number Movies")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
count(year, na.rm=T)
bollywood %>%
filter(year != "NA") %>%
count(year) %>%
ggplot(aes(x=year, y=n))+
geom_point()+
bollywood %>%
filter(year != "NA") %>%
count(year) %>%
ggplot(aes(x=year, y=n))+
geom_point()
bollywood %>%
filter(year != "NA") %>%
count(year) %>%
ggplot(aes(x=year, y=n))+
geom_point()+
geom_smooth(method=lm)
bollywood %>%
filter(year != "NA") %>%
count(year) %>%
ggplot(aes(x=year, y=n))+
geom_point()+
geom_smooth(method="lm")
bollywood %>%
filter(year != "NA") %>%
count(year) %>%
ggplot(aes(x=as.numeric(year), y=n))+
geom_point()+
geom_smooth(method="lm")
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="pink")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="darkblue")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="aquamarine")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="skyblue")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
group_by(year) %>%
summarize(med=median(revenue_inr))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr, fill=revenue_inr))+
geom_boxplot(fill="skyblue")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr, fill=year))+
geom_boxplot(fill="skyblue")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr, fill=year))+
geom_boxplot()+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="skyblue")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("hit_flop", "number_of_screens", "revenue_inr", "budget_inr"),
selected = "hit_flop"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
bollywood %>%
group_by(input$y) %>%
summarize(mean=mean(input$y)) %>%
ggplot(aes(x=as.factor(year), y=mean))+
geom_col()+
})
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("hit_flop", "number_of_screens", "revenue_inr", "budget_inr"),
selected = "hit_flop"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
bollywood %>%
group_by(input$y) %>%
summarize(mean=mean(input$y)) %>%
ggplot(aes(x=as.factor(year), y=mean))+
geom_col()
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("hit_flop", "number_of_screens", "revenue_inr", "budget_inr"),
selected = "hit_flop"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
bollywood %>%
group_by(!!sym(input$y)) %>%
summarize(mean=mean(!!sym(input$y))) %>%
ggplot(aes(x=as.factor(year), y=mean))+
geom_col()
})
}
shinyApp(ui, server)
by_genre <- bollywood %>%
group_by(genre) %>%
select(revenue_inr, hit_flop, number_of_screens, budget_inr)
View(by_genre)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("hit_flop", "number_of_screens", "revenue_inr", "budget_inr"),
selected = "hit_flop"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes(x=genre, y=input$y))+
geom_col()
})
}
shinyApp(ui, server)
View(by_genre)
bollywood %>%
group_by(genre) %>%
summarize(mean_rev=mean(revenue_inr), mean_hit=mean(hit_flop), mean_num_screens=mean(number_of_screens), mean_budget=mean(budget_inr))
by_genre <- bollywood %>%
group_by(genre) %>%
summarize(mean_rev=mean(revenue_inr), mean_hit=mean(hit_flop), mean_num_screens=mean(number_of_screens), mean_budget=mean(budget_inr))
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes(x=genre, y=input$y))+
geom_col()
})
}
shinyApp(ui, server)
View(by_genre)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x=genre, y=input$y))+
geom_col()
})
}
shinyApp(ui, server)
View(by_genre)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y))+
geom_col()
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y))+
geom_col()
})
}
shinyApp(ui, server)
by_genre <- bollywood %>%
group_by(genre) %>%
summarize(mean_revenue=mean(revenue_inr), mean_hit=mean(hit_flop), mean_num_screens=mean(number_of_screens), mean_budget=mean(budget_inr))
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y))+
geom_col()
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y, fill="genre"))+
geom_col()
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y, fill="genre"))+
geom_col()+
theme(axis.title.x = element_text(angle = 60))
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y, fill="genre"))+
geom_col()+
theme(axis.text.x = element_text(angle = 60))
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y, fill="genre"))+
geom_col()+
theme(axis.text.x = element_text(angle = 60))
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y))+
geom_col(fill="purple")+
theme(axis.text.x = element_text(angle = 60))
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y))+
geom_col(fill="lavender")+
theme(axis.text.x = element_text(angle = 60))
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("mean_revenue", "mean_hit", "mean_num_screens", "mean_budget"),
selected = "mean_revenue"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
by_genre %>%
ggplot(aes_string(x="genre", y=input$y))+
geom_col(fill="darkblue")+
theme(axis.text.x = element_text(angle = 60))
})
}
shinyApp(ui, server)
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=as.factor(year)))+
geom_bar(fill="darkblue", color="black")+
labs(title="Movies per Year", x="Year", y="Number Movies")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=as.factor(year)))+
geom_bar(fill="skyblue", color="black")+
labs(title="Movies per Year", x="Year", y="Number Movies")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=as.factor(year)))+
geom_bar(fill="purple", color="black")+
labs(title="Movies per Year", x="Year", y="Number Movies")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=as.factor(year)))+
geom_bar(fill="violet", color="black")+
labs(title="Movies per Year", x="Year", y="Number Movies")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
filter(new_director=="yes", year!="NA") %>%
group_by(year) %>%
summarize(n_uniq=n_distinct(director))%>%
ggplot(aes(x=as.factor(year), y=n_uniq))+
geom_col(fill="violet", color="black")+
labs(title="New Directors per Year", x="Year", y="Number of New Directors")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
group_by(year) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev))+
geom_col(fill="violet", color="black")+
labs(title="Average Revenue over Time", x="Year", y="Average Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="violet")+
labs(title="Revenue per Year", x="Year", y="Revenue (INR)")+
theme(plot.title=element_text(hjust=0.5, size=15))
knitr::opts_chunk$set(echo = TRUE)
options(scipen=999) #turning off scientific notation
bollywood %>%
filter(year %in% c(2012, 2013, 2014)) %>%
filter(genre=="masala") %>%
group_by(year) %>%
summarize(n_masala=n())
library(tidyverse)
library(janitor)
library(naniar)
library(ggplot2)
library(RColorBrewer)
bollywood %>%
filter(year %in% c(2013, 2014)) %>%
filter(genre=="masala") %>%
select(title, lead_star, director, year, revenue_inr)
View(bollywood)
