knitr::opts_chunk$set(echo = TRUE)
movies <- read_csv("bollywood.csv")")
movies <- read_csv("bollywood.csv")
library(tidyverse)
movies <- read_csv("bollywood.csv")
library(tidyverse)
library(janitor)
library(ggplot2)
library(dplyr)
movies <- read_csv("bollywood.csv")
movies1 <- read_csv("bollywood.csv")
movies1 <- read_csv("bollywood.csv")
movies2 <- read_csv("bollywood_hits.csv")
movies1 <- read_csv("bollywood.csv") %>%
clean_names()
movies2 <- read_csv("bollywood_hits.csv") %>%
clean_names()
View(movies2)
movies1 <- read_csv("bollywood.csv") %>%
clean_names() %>%
mutate(across(is.character), tolower())
movies1 <- read_csv("bollywood.csv") %>%
clean_names() %>%
mutate(across(is.character), ~tolower(.))
movies1 <- read_csv("bollywood.csv") %>%
clean_names() %>%
mutate(across(is.character, ~tolower(.))
movies1 <- read_csv("bollywood.csv") %>%
clean_names() %>%
mutate(across(is.character, ~tolower(.)))
movies2 <- read_csv("bollywood_hits.csv") %>%
clean_names() %>%
mutate(across(is.character, ~tolower(.)))
View(movies2)
View(movies1)
movies1 %>%
rename(title=movie_name)
movies1 <- movies1 %>%
rename(title=movie_name)
bollywood <- inner_join(movies1, movies2, by="title")
View(bollywood)
bollywood %>%
ggplot(aes(x=hit_flop, y=revenue_inr))+
geom_point()
bollywood %>%
ggplot(aes(x=as.factor(hit_flop), y=revenue_inr))+
geom_point()
bollywood %>%
ggplot(aes(x=as.factor(hit_flop), y=revenue_inr))+
geom_boxplot()
bollywood %>%
ggplot(aes(x=as.factor(hit_flop), y=number_of_screens))+
geom_boxplot()
library(tidyverse)
library(janitor)
library(ggmap)
register_stadiamaps("00e75a82-86db-4f72-a559-78a804dbcd35", write = FALSE)
register_stadiamaps("00e75a82-86db-4f72-a559-78a804dbcd35", write = FALSE)
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=5)
lat <- c(55.02, 70.37)
long <- c(-166.2, -131.3)
bbox <- make_bbox(long, lat, f = 0.03)
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=5)
spiders <- read_csv("data/spiders_with_locs.csv")%>% clean_names()
spiders <- spiders %>% filter(latitude<=42)
spiders %>%
select(latitude, longitude) %>%
summary()
lat <- c(34.67, 41.80)
long <- c(-124.1, -115.5)
bbox <- make_bbox(long, lat, f = 0.03) #f is the fraction of the bounding box to add to the range; either .03 or .05
#put longitude first
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=7) #zoom size has dramatic impact on how big map is in computer's memory
bear %>%
select(latitude, longitude) %>%
summary()
bear <- read_csv("data/bear-sightings.csv")
bear <- read_csv("data/bear-sightings.csv")
bear %>%
select(latitude, longitude) %>%
summary()
lat <- c(55.02, 70.37)
long <- c(-166.2, -131.3)
bbox <- make_bbox(long, lat, f = 0.03)
register_stadiamaps("00e75a82-86db-4f72-a559-78a804dbcd35", write = FALSE)
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=5)
View(bear)
ggmap(map1) +
geom_point(data = bear, aes(longitude, latitude), size=0.4) +
labs(x= "Longitude", y= "Latitude", title="Bear Locations")
lat <- c(55.02, 70.37)
long <- c(-166.2, -131.3)
bbox <- make_bbox(long, lat, f = 0.05)
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=5)
ggmap(map1) +
geom_point(data = bear, aes(longitude, latitude), size=0.4) +
labs(x= "Longitude", y= "Latitude", title="Bear Locations")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
movies <- read_csv("bollywood.csv")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
movies1 <- read_csv("bollywood.csv") %>%
clean_names() %>%
rename(title=movie_name) %>%
mutate(across(where(is.character), tolower))
movies2 <- read_csv("bollywood_hits.csv") %>%
clean_names() %>%
mutate(across(where(is.character), tolower))
bollywood <- inner_join(movies1, movies1, by="title")
View(bollywood)
names(bollywood)
library(tidyverse)
library(janitor)
library(ggmap)
library(tidyverse)
library(janitor)
library(ggmap)
library(readr)
bear_sightings <- read_csv("Desktop/BIS15W2025_akhatri/lab13/data/bear-sightings.csv")
View(bear_sightings)
bear_sightings
bear_sightings <- read_csv(bear_sightings.csv)
library(tidyverse)
library(janitor)
library(ggmap)
bear_sightings <- read_csv(bear_sightings.csv)
bear_sightings <- read_csv(bear-sightings.csv)
bear_sightings <- read_csv("data/bear-sightings.csv")
str(bear_sightings)
glimpse(bear_sightings)
library(tidyverse)
library(janitor)
library(ggmap)
grizzly <- read_csv("data/bear-sightings.csv")
grizzly <- read_csv("data/bear-sightings.csv") %>%
clean_names()
grizzly %>%
select(longitude, latitude) %>%
summary()
lat <- c(55.02, 70.37)
long <- c(-166.2, -131.3)
bbox <- make_bbox(long, lat, f=0.05)
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=3)
register_stadiamaps("50794c40-f2c7-46f8-ad55-c21d7f8fe4f6", write = FALSE)
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=3)
ggmap(map1)
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=5)
ggmap(map1)
ggmap(map1) +
geom_point(data=grizzly, aes(longitude, latitude), size = 0.5)+
labs(x = "Longitude",
y = "Latitude",
title = "Grizzly Observations")
map1 <- get_stadiamap(bbox, maptype = "stamen_terrain", zoom=5)
ggmap(map1)
ggmap(map1) +
geom_point(data=grizzly, aes(longitude, latitude), size = 0.5)+
labs(x = "Longitude",
y = "Latitude",
title = "Grizzly Observations")
glimpse(grizzly)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(naniar)
library(ggplot2)
library(RColorBrewer)
movies1 <- read_csv("bollywood.csv") %>%
clean_names() %>%
rename(title=movie_name) %>%
mutate(across(where(is.character), tolower)) #changing all characters to lowercase
movies1 <- read_csv("bollywood.csv") %>%
clean_names() %>%
mutate(across(where(is.character), tolower)) #changing all characters to lowercase
View(movies1)
movies2 <- read_csv("bollywood_hits.csv") %>%
clean_names() %>%
mutate(across(where(is.character), tolower))
movie_join <- inner_join(movies1, movies2, by="title")
bollywood <- movie_join %>%
select(-genre.y, -actors, -directors, -imdb_id) %>% #removing duplicate columns
rename(genre=genre.x) %>%
separate(release_date, into=c("date", "month", "year"), sep=" ") %>% #separate the date column
replace_with_na_all(condition = ~.x == "n/a") %>%
select(-release_year) #removing duplicate year column
View(bollywood)
bollywood <- movie_join %>%
select(-genre.y, -actors, -directors, -imdb_id) %>% #removing duplicate columns
rename(genre=genre.x) %>%
separate(release_date, into=c("date", "month", "year"), sep=" ") %>% #separate the date column
replace_with_na_all(condition = ~.x == "n/a") %>%
select(-release_year) #removing duplicate year column
summary(bollywood)
miss_var_summary(bollywood)
View(bollywood)
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=as.factor(year)))+
geom_bar(fill="skyblue", color="black")+
labs(title="Movies per Year", x="Year", y="Number Movies")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
filter(new_director=="yes", year!="NA") %>%
group_by(year) %>%
summarize(n_uniq=n_distinct(director))%>%
ggplot(aes(x=as.factor(year), y=n_uniq))+
geom_col(fill="skyblue", color="black")+
labs(title="New Directors per Year", x="Year", y="Number of New Directors")+
theme(plot.title = element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
group_by(year) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev))+
geom_col(fill="skyblue", color="black")+
labs(title="Average Revenue over Time", x="Year", y="Average Revenue")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="skyblue")+
labs(title="Revenue per Year", x="Year", y="Revenue")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year %in% c(2012, 2013, 2014)) %>%
filter(!genre %in% c("adult", "suspense","fantasy")) %>%
ggplot(aes(x=genre, y=revenue_inr/10000, fill=genre))+
geom_boxplot()+
facet_wrap(~year)+
scale_fill_brewer(palette="RdYlGn")+
coord_flip()+
theme(axis.text.x=element_text(angle=20))+
labs(title="Revenue Range over Time", y="Revenue x 10^-3 in Rupees", x="Genre")
bollywood %>%
filter(year %in% c(2012, 2013, 2014)) %>%
filter(genre=="masala") %>%
group_by(year) %>%
summarize(n_masala=n())
bollywood %>%
filter(year %in% c(2013, 2014)) %>%
filter(genre=="masala") %>%
select(title, lead_star, director, year, revenue_inr)
bollywood %>%
filter(lead_star=="ajay devgn" | lead_star=="shahrukh khan"| lead_star=="ranveer singh") %>%
group_by(year, lead_star) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev, group=lead_star, color=lead_star))+
geom_point()+
geom_line()+
labs(title="Avg Movie Revenue Over Time", x="Year", y="Average Revenue", color="Actor")+
theme(plot.title=element_text(hjust=0.5, size=15))
options(scipen=999) #turning off scientific notation
bollywood %>%
filter(lead_star=="ajay devgn" | lead_star=="shahrukh khan"| lead_star=="ranveer singh") %>%
group_by(year, lead_star) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev, group=lead_star, color=lead_star))+
geom_point()+
geom_line()+
labs(title="Avg Movie Revenue Over Time", x="Year", y="Average Revenue", color="Actor")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(director=="sajid khan" | director=="ali abbas zafar"| director=="farah khan" | director=="rohit shetty") %>%
group_by(year, director) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev, group=director, color=director))+
geom_point()+
geom_line()+
labs(title="Avg Movie Revenue Over Time", x="Year", y="Average Revenue", color="director")+
theme(plot.title=element_text(hjust=0.5, size=15))
View(bollywood)
View(bollywood)
View(movies1)
View(movies2)
View(movie_join)
View(movies1)
movies1 <- read_csv("bollywood.csv") %>%
clean_names() %>%
mutate(across(where(is.character), tolower)) #changing all characters to lowercase
View(movies1)
movies1 <- read_csv("movies1.csv") %>%
clean_names() %>%
mutate(across(where(is.character), tolower)) #changing all characters to lowercase
View(movies1)
movies2 <- read_csv("bollywood_hits.csv") %>%
clean_names() %>%
mutate(across(where(is.character), tolower))
View(movies1)
movie_join <- inner_join(movies1, movies2, by="title")
View(movies1)
movies1 <- read_csv("movies1.csv") %>%
rename(title=movie_name)
movies1 <- read_csv("movies1.csv") %>%
rename(title=movie_name) %>%
clean_names() %>%
mutate(across(where(is.character), tolower)) #changing all characters to lowercase
View(movies1)
movies1 <- read_csv("movies1.csv") %>%
rename(title=movie_name) %>%
clean_names() %>%
mutate(across(where(is.character), tolower)) #changing all characters to lowercase
View(movies1)
movies1 <- read_csv("movies1.csv")# %>%
#rename(title=movie_name) %>%
# clean_names() %>%
#mutate(across(where(is.character), tolower)) #changing all characters to lowercase
View(movies1)
movies1 <- read_csv("movies1.csv") %>%
clean_names()
#mutate(across(where(is.character), tolower)) #changing all characters to lowercase
View(movies1)
movies1 <- read_csv("movies1.csv") %>%
clean_names() %>%
rename(title=movie_name) %>%
mutate(across(where(is.character), tolower)) #changing all characters to lowercase
movies2 <- read_csv("bollywood_hits.csv") %>%
clean_names() %>%
mutate(across(where(is.character), tolower))
movie_join <- inner_join(movies1, movies2, by="title")
View(movie_join)
bollywood <- movie_join %>%
select(-genre.y, -actors, -directors, -imdb_id) %>% #removing duplicate columns
rename(genre=genre.x) %>%
separate(release_date, into=c("date", "month", "year"), sep=" ") %>% #separate the date column
replace_with_na_all(condition = ~.x == "n/a") %>%
select(-release_year) #removing duplicate year column
View(bollywood)
View(bollywood)
View(bollywood)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("hit_flop", "number_of_screens", "revenue_inr", "budget_inr"),
selected = "hit_flop"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
bollywood %>%
group_by(year) %>%
summarize(avg=mean(input$y)) %>%
ggplot(aes_string(x=as.factor(year), y=avg))+
geom_col()
})
}
shinyApp(ui, server)
View(bollywood)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("hit_flop", "number_of_screens", "revenue_inr", "budget_inr"),
selected = "hit_flop"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
bollywood %>%
group_by(year) %>%
summarize(avg=mean(as.numeric(input$y))) %>%
ggplot(aes_string(x=as.factor(year), y=avg))+
geom_col()
})
}
shinyApp(ui, server)
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("hit_flop", "number_of_screens", "revenue_inr", "budget_inr"),
selected = "hit_flop"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
bollywood %>%
group_by(year) %>%
summarize(avg=mean(.data[[input$y]]) %>%
ggplot(aes_string(x=as.factor(year), y=avg))+
geom_col()
})
library(shiny)
ui <- fluidPage(
selectInput("y",
"Select Y Variable",
choices = c("hit_flop", "number_of_screens", "revenue_inr", "budget_inr"),
selected = "hit_flop"),
plotOutput("plot", width="500px", height="400px")
)
server <- function(input, output, session) {
output$plot <- renderPlot({
bollywood %>%
group_by(year) %>%
summarize(avg=mean(.data[[input$y]])) %>%
ggplot(aes_string(x=as.factor(year), y=avg))+
geom_col()
})
}
shinyApp(ui, server)
options(scipen=999) #turning off scientific notation
options(scipen=999) #turning off scientific notation
bollywood %>%
filter(year != "NA") %>%
group_by(year) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev))+
geom_col(fill="skyblue", color="black")+
labs(title="Average Revenue over Time", x="Year", y="Average Revenue")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="skyblue")+
labs(title="Revenue per Year", x="Year", y="Revenue")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
ggplot(aes(x=year, y=revenue_inr))+
geom_boxplot(fill="skyblue")+
labs(title="Revenue per Year", x="Year", y="Revenue in Rupees")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year != "NA") %>%
group_by(year) %>%
summarize(avg_rev=mean(revenue_inr)) %>%
ggplot(aes(x=year, y=avg_rev))+
geom_col(fill="skyblue", color="black")+
labs(title="Average Revenue over Time", x="Year", y="Average Revenue in Rupees")+
theme(plot.title=element_text(hjust=0.5, size=15))
bollywood %>%
filter(year %in% c(2012, 2013, 2014)) %>%
filter(!genre %in% c("adult", "suspense","fantasy")) %>%
ggplot(aes(x=genre, y=revenue_inr/10000, fill=genre))+
geom_boxplot()+
facet_wrap(~year)+
scale_fill_brewer(palette="RdYlGn")+
coord_flip()+
theme(axis.text.x=element_text(angle=20))+
labs(title="Revenue Range over Time", y="Revenue x 10^-3 (Rupees)", x="Genre")
bollywood %>%
filter(year %in% c(2012, 2013, 2014)) %>%
filter(genre=="masala") %>%
group_by(year) %>%
summarize(n_masala=n())
bollywood %>%
filter(year %in% c(2013, 2014)) %>%
filter(genre=="masala") %>%
select(title, lead_star, director, year, revenue_inr)
